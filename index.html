<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>まごはわやさし4</title>
    <link rel="apple-touch-icon" href="magowayasa4.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .check-box {
            transition: all 0.2s ease-in-out;
            border: 2px solid #e5e7eb; /* gray-200 */
        }
        .check-box.checked {
            background-color: #fffbeb; /* amber-50 */
            border-color: #fcd34d; /* amber-300 */
        }
    </style>
</head>
<body class="bg-white flex items-center justify-center min-h-screen">
    <div class="w-full max-w-md mx-auto bg-amber-50 rounded-2xl shadow-lg p-6 md:p-8">
        
        <!-- 週のナビゲーション -->
        <div class="flex items-center justify-between mb-6">
            <button id="prev-week" class="transition-colors p-2">
                <i class="fas fa-chevron-left fa-fw text-2xl text-gray-500 hover:text-gray-800"></i>
            </button>
            <h2 id="week-display" class="text-xl font-semibold text-gray-700 tracking-wider"></h2>
            <button id="next-week" class="transition-colors p-2">
                <i class="fas fa-chevron-right fa-fw text-2xl text-gray-500 hover:text-gray-800"></i>
            </button>
        </div>

        <!-- チェックリスト -->
        <div id="checklist" class="space-y-4">
            <!-- JavaScriptで項目がここに追加されます -->
        </div>

        <!-- めやす -->
        <div class="mt-8 pt-6 border-t border-amber-200 text-gray-600">
            <h3 class="text-lg font-bold text-center mb-4 text-gray-700">1週間あたりのめやす量（成人）</h3>
            <div class="space-y-4 text-sm">
                <div>
                    <h4 class="font-bold">① 豆類（大豆製品・豆）</h4>
                    <p class="pl-4">例：豆腐1/3丁、納豆1パック、煮豆小鉢など</p>
                    <p class="pl-4">週に 350〜700g 程度</p>
                </div>
                <div>
                    <h4 class="font-bold">② ごまナッツ（種実類）</h4>
                    <p class="pl-4">例：ごま大さじ1〜2、アーモンド5〜10粒</p>
                    <p class="pl-4">週に 70〜140g 程度</p>
                </div>
                <div>
                    <h4 class="font-bold">③ 海藻</h4>
                    <p class="pl-4">例：わかめの味噌汁、ひじき煮、小鉢1品程度</p>
                    <p class="pl-4">週に 35〜70g（乾物）</p>
                </div>
                <div>
                    <h4 class="font-bold">④ 野菜</h4>
                    <p class="pl-4">例：生野菜サラダ1皿＋煮物やお浸し2皿くらい</p>
                    <p class="pl-4">週に 2,450g（2.5kg程度）</p>
                </div>
                <div>
                    <h4 class="font-bold">⑤ 魚類</h4>
                    <p class="pl-4">例：切り身1切れ（80g）、刺身小鉢</p>
                    <p class="pl-4">週に 420〜700g 程度</p>
                </div>
                <div>
                    <h4 class="font-bold">⑥ きのこ類</h4>
                    <p class="pl-4">例：しいたけ2枚、しめじ1/2パック</p>
                    <p class="pl-4">週に 350〜500g 程度</p>
                </div>
            </div>
        </div>
        
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const weekDisplay = document.getElementById('week-display');
            const checklistContainer = document.getElementById('checklist');
            const prevWeekBtn = document.getElementById('prev-week');
            const nextWeekBtn = document.getElementById('next-week');

            let currentDate = new Date();
            let appData = {};

            const foodCategories = [
                { id: 'mame', name: 'まめ', emoji: '🫘' },
                { id: 'goma', name: 'ごまナッツ', emoji: '🥜' },
                { id: 'kaiso', name: 'かいそう', emoji: '🌿' },
                { id: 'yasai', name: 'やさい', emoji: '🥬' },
                { id: 'sakana', name: 'さかな', emoji: '🐟' },
                { id: 'kinoko', name: 'きのこ', emoji: '🍄' },
            ];

            // データの読み込み
            function loadData() {
                // 別のキーを使用してデータを保存
                const savedData = localStorage.getItem('mealCheckDataV5_Checkbox');
                appData = savedData ? JSON.parse(savedData) : {};
            }

            // データの保存
            function saveData() {
                localStorage.setItem('mealCheckDataV5_Checkbox', JSON.stringify(appData));
            }

            function getWeekKey(date) {
                const d = new Date(date);
                d.setHours(0, 0, 0, 0);
                d.setDate(d.getDate() + 4 - (d.getDay() || 7));
                const yearStart = new Date(d.getFullYear(), 0, 1);
                const weekNo = Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
                return `${d.getFullYear()}-${weekNo}`;
            }
            
            function getWeekDateRange(date) {
                const d = new Date(date);
                const day = d.getDay();
                const diffStart = d.getDate() - day + (day === 0 ? -6 : 1); // 週の始まりを月曜日に設定
                const startDate = new Date(d.setDate(diffStart));
                const endDate = new Date(new Date(startDate).setDate(startDate.getDate() + 6));
                return { startDate, endDate };
            }

            function render() {
                const { startDate, endDate } = getWeekDateRange(currentDate);
                const format = (dt) => `${dt.getMonth() + 1}/${dt.getDate()}`;
                weekDisplay.textContent = `${format(startDate)} ~ ${format(endDate)}`;

                const weekKey = getWeekKey(currentDate);
                if (!appData[weekKey]) {
                    appData[weekKey] = {};
                    foodCategories.forEach(cat => {
                        appData[weekKey][cat.id] = [false, false, false, false]; // 4つのチェック状態
                    });
                }
                const weekData = appData[weekKey];

                checklistContainer.innerHTML = '';
                foodCategories.forEach(category => {
                    const row = document.createElement('div');
                    row.className = 'flex justify-between items-center';

                    const label = document.createElement('div');
                    label.className = 'w-2/5 text-lg font-semibold text-gray-700 whitespace-nowrap pr-2';
                    label.textContent = `${category.emoji} ${category.name}`;
                    row.appendChild(label);
                    
                    const checkboxesWrapper = document.createElement('div');
                    checkboxesWrapper.className = 'w-3/5 flex justify-around items-center gap-1';
                    
                    for (let i = 0; i < 4; i++) {
                        const checkBox = document.createElement('div');
                        checkBox.className = 'check-box w-12 h-12 flex items-center justify-center text-3xl bg-white rounded-lg shadow-sm cursor-pointer transform hover:scale-110';
                        checkBox.dataset.category = category.id;
                        checkBox.dataset.index = i;
                        
                        const isChecked = weekData[category.id] && weekData[category.id][i];
                        
                        if (isChecked) {
                            checkBox.classList.add('checked');
                            checkBox.innerHTML = category.emoji;
                        }
                        checkboxesWrapper.appendChild(checkBox);
                    }
                    row.appendChild(checkboxesWrapper);
                    checklistContainer.appendChild(row);
                });
            }

            prevWeekBtn.addEventListener('click', () => {
                currentDate.setDate(currentDate.getDate() - 7);
                render();
            });

            nextWeekBtn.addEventListener('click', () => {
                currentDate.setDate(currentDate.getDate() + 7);
                render();
            });

            checklistContainer.addEventListener('click', (e) => {
                const checkBox = e.target.closest('.check-box');
                if (checkBox) {
                    const category = checkBox.dataset.category;
                    const index = parseInt(checkBox.dataset.index, 10);
                    const weekKey = getWeekKey(currentDate);
                    
                    appData[weekKey][category][index] = !appData[weekKey][category][index];
                    const isChecked = appData[weekKey][category][index];

                    checkBox.classList.toggle('checked', isChecked);
                    if(isChecked) {
                        checkBox.innerHTML = foodCategories.find(c => c.id === category).emoji;
                    } else {
                        checkBox.innerHTML = '';
                    }
                    
                    saveData();
                }
            });

            loadData();
            render();
        });
    </script>
</body>
</html>




